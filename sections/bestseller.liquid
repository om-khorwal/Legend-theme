{% schema %}
{
  "name": "Product Tabs",
  "settings": [
    {
      "type": "header",
      "content": "Tab Settings"
    },
    {
      "type": "text",
      "id": "bestseller_title",
      "label": "Bestseller Tab Title",
      "default": "Bestsellers"
    },
    {
      "type": "text",
      "id": "new_arrival_title",
      "label": "New Arrival Tab Title",
      "default": "New Arrivals"
    },

    {
      "type": "header",
      "content": "Typography Settings"
    },

    {
      "type": "select",
      "id": "font_family",
      "label": "Font Family",
      "options": [
        { "value": "Arial", "label": "Arial" },
        { "value": "Helvetica", "label": "Helvetica" },
        { "value": "Georgia", "label": "Georgia" },
        { "value": "Times New Roman", "label": "Times New Roman" },
        { "value": "Courier New", "label": "Courier New" }
      ],
      "default": "Arial"
    },

    {
      "type": "header",
      "content": "Product Title Style"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Title Color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "title_font_size",
      "label": "Title Font Size",
      "min": 12,
      "max": 36,
      "step": 1,
      "default": 18
    },

    {
      "type": "header",
      "content": "Price Style"
    },
    {
      "type": "color",
      "id": "price_color",
      "label": "Price Color",
      "default": "#333333"
    },
    {
      "type": "range",
      "id": "price_font_size",
      "label": "Price Font Size",
      "min": 12,
      "max": 30,
      "step": 1,
      "default": 16
    },

    {
      "type": "header",
      "content": "Variant Style"
    },
    {
      "type": "color",
      "id": "variant_color",
      "label": "Variant Text Color",
      "default": "#444444"
    },
    {
      "type": "range",
      "id": "variant_font_size",
      "label": "Variant Font Size",
      "min": 12,
      "max": 30,
      "step": 1,
      "default": 14
    },

    {
      "type": "header",
      "content": "Button Style"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button Text Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_bg_color",
      "label": "Button Background Color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "button_font_size",
      "label": "Button Font Size",
      "min": 12,
      "max": 30,
      "step": 1,
      "default": 14
    }
  ],
  "blocks": [
    {
      "type": "bestseller",
      "name": "Bestseller Product",
      "settings": [
        {
          "type": "product",
          "id": "product",
          "label": "Select Bestseller Product"
        }
      ]
    },
    {
      "type": "newarrival",
      "name": "New Arrival Product",
      "settings": [
        {
          "type": "product",
          "id": "product",
          "label": "Select New Arrival Product"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Product Tabs",
      "category": "Custom"
    }
  ]
}
{% endschema %}

<div class="product-tabs">
  <div class="tab-buttons">
    <button onclick="showTab('bestseller')" class="tab-button active">{{ settings.bestseller_title }}</button>
    <button onclick="showTab('newarrival')" class="tab-button">{{ settings.new_arrival_title }}</button>
  </div>

  <div id="bestseller" class="tab-content active">
    <div class="product-list">
      {% for block in section.blocks %}
        {% if block.type == 'bestseller' %}
          {% assign product = block.settings.product %}
          {% if product != blank %}
            {% assign product = all_products[product] %}
            <div class="product-card">
              {% if product.images.size > 0 %}
                <div class="carousel">
                  {% for image in product.images %}
                    <img src="{{ image | img_url: 'medium' }}" style="width:100%; margin-bottom: 10px;"
                    width="100" height="auto">
                  {% endfor %}
                </div>
              {% endif %}
              <div class="title">{{ product.title }}</div>
              <div class="price">{{ product.price | money }}</div>
              {% if product.variants.size > 1 %}
                <div class="variant">
                  {% for variant in product.variants %}
                    {{ variant.title -}}
                    {%- unless forloop.last %}, {% endunless %}
                  {% endfor %}
                </div>
              {% endif %}
              <button class="btn-add" onclick="addItemToCart({{ product.variants.first.id }})">Add to Cart</button>
            </div>
          {% endif %}
        {% endif %}
      {% endfor %}
    </div>
  </div>

  <div id="newarrival" class="tab-content" style="display:none;">
    <div class="product-list">
      {% for block in section.blocks %}
        {% if block.type == 'newarrival' %}
          {% assign product = block.settings.product %}
          {% if product != blank %}
            {% assign product = all_products[product] %}
            <div class="product-card">
              {% if product.images.size > 0 %}
                <div class="carousel">
                  {% for image in product.images %}
                    <img
                      src="{{ image | img_url: 'medium' }}"
                      style="width:100%; margin-bottom: 10px;"
                      width="100"
                      height="auto"
                    >
                  {% endfor %}
                </div>
              {% endif %}
              <div class="title">{{ product.title }}</div>
              <div class="price">{{ product.price | money }}</div>
              {% if product.variants.size > 1 %}
                <div class="variant">
                  {% for variant in product.variants %}
                    {{ variant.title -}}
                    {%- unless forloop.last %}, {% endunless %}
                  {% endfor %}
                </div>
              {% endif %}
              <button class="btn-add" onclick="addItemToCart({{ product.variants.first.id }})">Add to Cart</button>
            </div>
          {% endif %}
        {% endif %}
      {% endfor %}
    </div>
  </div>
</div>

<script>
  function showTab(tabName) {
    const tabs = document.querySelectorAll('.tab-content');
    const buttons = document.querySelectorAll('.tab-button');

    tabs.forEach((tab) => (tab.style.display = 'none'));
    buttons.forEach((btn) => btn.classList.remove('active'));

    document.getElementById(tabName).style.display = 'block';
    event.target.classList.add('active');
  }

  function addItemToCart(variantId) {
    fetch('/cart/add.js', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ id: variantId, quantity: 1 }),
    })
      .then((res) => res.json())
      .then((data) => {
        alert('Item added to cart!');
      });
  }
</script>
